<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BestStocks</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif}
body{min-height:100vh;display:flex;justify-content:center;align-items:center;background:#1e1e1e;color:#5fd0ff}
.container{width:1250px;min-height:750px;background:rgba(40,40,40,.95);border-radius:35px;border:2px solid #5fd0ff;box-shadow:0 0 60px rgba(95,208,255,.3);display:flex;overflow:hidden;animation:fadeIn .8s ease}
.sidebar{width:250px;background:rgba(30,30,30,.95);border-right:2px solid #5fd0ff;padding:30px;display:flex;flex-direction:column;gap:20px}
.logo{font-size:22px;font-weight:bold;margin-bottom:20px;text-align:center}
.nav-btn,.primary-btn,.buy-btn,.edit-btn,.close-btn{border:none;padding:14px 22px;border-radius:50px;font-weight:bold;cursor:pointer;transition:.3s ease;font-size:15px}
.nav-btn{background:transparent;border:2px solid #5fd0ff;color:#5fd0ff}
.nav-btn:hover{background:#5fd0ff;color:#1e1e1e}
.main{flex:1;padding:60px;display:flex;flex-direction:column;gap:40px;position:relative}
.card{background:rgba(50,50,50,.85);border:2px solid #5fd0ff;border-radius:25px;padding:30px;position:relative;margin-bottom:10px;box-shadow:0 0 25px rgba(95,208,255,.15);transition:all .4s ease;animation:slideUp .6s ease}
.card:hover{box-shadow:0 0 35px rgba(95,208,255,.35);transform:translateY(-5px)}
.primary-btn,.buy-btn,.edit-btn,.close-btn{background:#5fd0ff;color:#1e1e1e}
.primary-btn:hover,.buy-btn:hover,.edit-btn:hover,.close-btn:hover{transform:scale(1.05)}
.stock-item{margin-bottom:35px;padding:20px;border:1px solid #5fd0ff;border-radius:18px;transition:all .3s ease}
.stock-item:hover{box-shadow:0 0 20px rgba(95,208,255,.3);transform:scale(1.02)}
.stock-header{display:flex;justify-content:space-between;margin-bottom:10px}
.percentage{font-weight:bold}
.positive{color:#00ff88}
canvas{margin-top:10px}
#profileSection{display:none}
#loginPage{position:fixed;top:0;left:0;width:100%;height:100%;background:#1e1e1e;display:flex;justify-content:center;align-items:center;flex-direction:column;z-index:1000}
#loginBtn{border-radius:20px;background:#5fd0ff;color:#1e1e1e;border:none;padding:12px 25px;margin-top:20px;font-weight:bold;cursor:pointer;transition:.3s}
#loginBtn:hover{transform:scale(1.05)}
#editUsernameInput{display:none;padding:10px;margin-left:10px;border-radius:15px;border:none}
#closeProfileBtn{position:absolute;top:15px;right:15px}
#dashboardSignOut{background:#ff4d4d;color:white;border:none;padding:14px 22px;border-radius:50px;font-weight:bold;cursor:pointer;transition:.3s;margin-top:auto}
#dashboardSignOut:hover{background:#ff1a1a;transform:scale(1.05)}
#dashboardSignOut:hover{background:#ff1a1a;transform:scale(1.05)}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
h2{animation:fadeIn 1s ease}
p{animation:fadeIn 1.3s ease}
</style>
</head>
<body>
<div id="loginPage">
<h2>Login to BestStocks</h2>
<input type="text" id="usernameInput" placeholder="Enter your username" style="padding:12px;border-radius:15px;border:none;margin-top:15px;width:220px;text-align:center"/>
<button id="loginBtn">Login</button>
</div>
<div class="container" style="display:none" id="mainContainer">
<div class="sidebar">
<div class="logo">BestStocks</div>
<button class="nav-btn" id="dashboardBtn">Dashboard</button>
<button class="nav-btn" id="profileBtn">Profile</button>
<button id="dashboardSignOut">Sign Out</button>
</div>
<div class="main" id="mainContent">
<div id="dashboardSection">
<div class="card"><h2>Welcome to BestStocks</h2><p>Find rising stocks for you</p></div>
<div class="card" style="display:flex;gap:30px;justify-content:center">
<button class="primary-btn" id="btn10">£10-£50</button>
<button class="primary-btn" id="btn50">£50+</button>
</div>
<div class="card" id="results" style="display:none"></div>
</div>
<div id="profileSection" class="card">
<span id="usernameDisplay">Username</span>
<input type="text" id="editUsernameInput"/>
<button class="edit-btn" id="editUsernameBtn">Edit</button>

<button class="close-btn" id="closeProfileBtn">X</button>
</div>
</div>
</div>
<script>
let username=localStorage.getItem('beststocks_username')||'';

document.getElementById('loginBtn').onclick=()=>{
const input=document.getElementById('usernameInput').value.trim();
username=input||'User';
localStorage.setItem('beststocks_username',username);
document.getElementById('usernameDisplay').textContent=username;
document.getElementById('loginPage').style.display='none';
document.getElementById('mainContainer').style.display='flex';
};

const dashboardBtn=document.getElementById('dashboardBtn');
const profileBtn=document.getElementById('profileBtn');
const profileSection=document.getElementById('profileSection');
const dashboardSection=document.getElementById('dashboardSection');
const closeProfileBtn=document.getElementById('closeProfileBtn');
const editUsernameBtn=document.getElementById('editUsernameBtn');
const usernameDisplay=document.getElementById('usernameDisplay');
const editUsernameInput=document.getElementById('editUsernameInput');
const signOutBtn=document.getElementById('dashboardSignOut');

profileBtn.onclick=()=>{dashboardSection.style.display='none';profileSection.style.display='block';editUsernameInput.value=username};
dashboardBtn.onclick=()=>{profileSection.style.display='none';dashboardSection.style.display='block'};
closeProfileBtn.onclick=()=>{profileSection.style.display='none';dashboardSection.style.display='block'};

editUsernameBtn.onclick=()=>{
if(editUsernameInput.style.display==='none'){
editUsernameInput.style.display='inline';
editUsernameInput.focus();
editUsernameBtn.textContent='Save';
}else{
const newName=editUsernameInput.value.trim();
if(newName){
username=newName;
usernameDisplay.textContent=username;
localStorage.setItem('beststocks_username',username);
}
editUsernameInput.style.display='none';
editUsernameBtn.textContent='Edit';
}
};

signOutBtn.onclick=()=>{
username='';
localStorage.removeItem('beststocks_username');
document.getElementById('usernameInput').value='';
document.getElementById('mainContainer').style.display='none';
document.getElementById('loginPage').style.display='flex';
profileSection.style.display='none';
dashboardSection.style.display='block';
};

// Auto-login if saved
if(username){
document.getElementById('usernameDisplay').textContent=username;
document.getElementById('loginPage').style.display='none';
document.getElementById('mainContainer').style.display='flex';
}

const API_KEY='d66dlihr01qnh6sdg03gd66dlihr01qnh6sdg040';

async function fetchAllSymbols(){
const res=await fetch(`https://finnhub.io/api/v1/stock/symbol?exchange=US&token=${API_KEY}`);
const data=await res.json();
return data.slice(0,100).map(s=>s.symbol);
}

async function fetchStock(symbol){
try{
const res=await fetch(`https://finnhub.io/api/v1/quote?symbol=${symbol}&token=${API_KEY}`);
const data=await res.json();
if(!data||typeof data.c!=='number'||typeof data.o!=='number')return null;
const change=((data.c-data.o)/data.o)*100;
if(change<=0)return null;
return{symbol,price:data.c,change,history:Array(7).fill(data.c)};
}catch{return null}
}

async function loadStocks(min,max){
const results=document.getElementById('results');
results.innerHTML='Loading...';
results.style.display='block';

const symbols=await fetchAllSymbols();
const shuffled=symbols.sort(()=>0.5-Math.random()).slice(0,20);

const stocks=await Promise.all(shuffled.map(s=>fetchStock(s)));

const filtered=stocks.filter(s=>s&&s.price>=min&&(max? s.price<=max:true));

results.innerHTML='';

if(filtered.length===0){results.innerHTML='No rising stocks found in this range.';return}

filtered.forEach(stock=>{
const div=document.createElement('div');
div.className='stock-item';
div.innerHTML=`<div class='stock-header'><span>${stock.symbol} (£${stock.price.toFixed(2)})</span><span class='percentage positive'>${stock.change.toFixed(2)}%</span></div><button class='buy-btn' onclick='buyStock("${stock.symbol}")'>Buy</button><canvas id='chart-${stock.symbol}' height='80'></canvas>`;
results.appendChild(div);
new Chart(document.getElementById(`chart-${stock.symbol}`),{
type:'line',
data:{labels:['1','2','3','4','5','6','7'],datasets:[{data:stock.history,borderColor:'#5fd0ff',tension:.4}]},
options:{plugins:{legend:{display:false}},scales:{x:{display:false},y:{display:false}}}
});
});
}

function buyStock(symbol){window.open(`https://www.google.com/search?q=buy+${symbol}+stock`,'_blank')}

document.getElementById('btn10').onclick=()=>loadStocks(10,50);
document.getElementById('btn50').onclick=()=>loadStocks(50,null);
</script>
</body>
</html>
